dist: trusty
sudo: required
language: java
jdk:
  - oraclejdk8
git:
  depth: 3
cache:
  directories:
    - "$HOME/.m2"
services:
  - postgresql
before_script:
  - psql -c 'create database frameworkeventstore;' -U postgres
  - psql -c 'create database frameworkviewstore;' -U postgres
  - psql -c 'create database frameworkfilestore;' -U postgres
  - psql -c 'create database frameworksystem;' -U postgres
  - psql -c 'create database fileservice;' -U postgres
  - psql -c "CREATE USER framework WITH PASSWORD 'framework';" -U postgres
  - psql -c "CREATE USER fileservice WITH PASSWORD 'fileservice';" -U postgres
addons:
  postgresql: '9.5'
before_install:
  - git clone https://github.com/CJSCommonPlatform/travis-settings.git target/travis-settings
  - ln -sfT ${PWD}/target/travis-settings/settings.xml ${HOME}/.m2/settings.xml
  - ln -sfT ${PWD}/target/travis-settings/mvnw mvnw
  - ln -sft ${PWD} ${PWD}/target/travis-settings/.mvn
install: "${PWD}/target/travis-settings/java/install.sh -e -DexcludeGroupIds=uk.gov.justice.service,uk.gov.justice.services"
script: "${PWD}/target/travis-settings/java/script-install.sh coveralls:report"
after_success: "${PWD}/target/travis-settings/java/after_success.sh"
notifications:
env:
  global:
    - PGPORT=5432
    - secure: j9aIMo7+WEaWf+7laaEjsHULJE6U98f16zHleAYGBtZhl8FXJdUgc984G/dUqYGwIsfQnYBlNFKZ2FZ3koQB54VJEXKxhLn3Yt6eM3sbH/7D3CHIiqzQy5P2gH2TzzroH1rN4lUuDRYQXq2Es+5X1pU03cZKrD2j7sJL93GT+c6pH1A66Qyv5wKHj5tJ6nOgUV5TrDKvZCWXeMDFUNoGnXDv7ztkIogcOhFkJJWjBU/CkZCNrhRfV4LKzo2Vu8H9xpqDcfusBJ2TY1vF2mKq3fkfts0LQ5A7FLXukTl3uE2+Qbaq9++/E9e9cTkrNlalmBGJavlSVpsGXsPHS7Ny9kwmp1rUmrp++ZdJdnv1JWQ6aD8BryTWRmoTPjY8a2QH6jHm2a8etkKp6MbDAeLdbvEKqMLIU2NfKO6zHZxWL3iCz2/YwMIF8gG+Yaj0EMe4BazFLkowdHiwbXMpcwtRLzEIaD4DF1RXOLkr8tMcHRAo9uRNcaG0qup/4MtkeKX2xnukud4WK5pDpTLYYqcgP7TpnEAoB/zrM6Y9JxUMUP7sqjfHi4SJFqXnKcSPMtfN5GuEL9b1559ApINRiyvDnyQOREvAJxqt17Z54FgJ4q9zkBlaOAZUCxlAmBa/vnzXN0MbVNmo9qWdpJHbARefmWfX7R/8vimWZy8jC1BqQTw=
